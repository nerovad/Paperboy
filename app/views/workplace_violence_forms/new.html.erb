<!-- Generated by Paperboy Form Builder -->
<div class="form-header">
  <h1>Workplace Violence</h1>
</div>

<div class="form-wrapper" data-controller="form-navigation conditional-fields">
  <%= form_with model: @workplace_violence_form, local: true do |form| %>

<!-- Page 1: Employee Info -->
<div class="form-page">
  <h2>Employee Info</h2>
<div class="form-row d-flex flex-wrap">
  <div class="form-group flex-fill">
    <%= form.label :employee_id, "Employee ID" %>
    <%= form.text_field :employee_id,
          value: @prefill_data[:employee_id],
          class: "form-control",
          readonly: true %>
  </div>

  <div class="form-group flex-fill">
    <%= form.label :name, "Name" %>
    <%= form.text_field :name,
          value: @prefill_data[:name],
          class: "form-control",
          readonly: true %>
  </div>

  <div class="form-group flex-fill">
    <%= form.label :phone, "Phone" %>
    <%= form.text_field :phone,
          value: @prefill_data[:phone],
          class: "form-control",
          required: true,
          placeholder: "e.g. 555-555-5555",
          title: "Enter a 10-digit phone number like 555-555-5555",
          data: {
            controller: "phone",
            phone_target: "input",
            action: "input->phone#format paste->phone#format blur->phone#validate"
          },
          "aria-describedby": "phoneHelp phoneError",
          pattern: "\\d{3}-\\d{3}-\\d{4}",
          inputmode: "numeric",
          autocomplete: "tel" %>
    <small id="phoneHelp" class="help-text text-muted"></small>
    <div id="phoneError" data-phone-target="error" class="field-error" aria-live="polite"></div>
  </div>

  <div class="form-group flex-fill">
    <%= form.label :email, "Email" %>
    <%= form.text_field :email,
          value: @prefill_data[:email],
          class: "form-control",
          required: true %>
  </div>
</div>
      </div>

<!-- Page 2: Agency Info -->
<div class="form-page" style="display:none;">
  <h2>Agency Info</h2>
<div data-controller="gsabss-selects" class="form-row d-flex flex-wrap">
  <div class="form-group">
    <%= form.label :agency, "Agency" %>
    <%= form.select :agency,
          options_for_select(@agency_options, @prefill_data[:agency]),
          {},
          class: "form-control",
          id: "agency-select",
          data: {
            gsabss_selects_target: "agency",
            action: "change->gsabss-selects#loadDivisions"
          } %>
  </div>

  <div class="form-group">
    <%= form.label :division, "Division" %>
    <%= form.select :division,
          options_for_select(@division_options, @prefill_data[:division]),
          {},
          class: "form-control",
          id: "division-select",
          data: {
            gsabss_selects_target: "division",
            action: "change->gsabss-selects#loadDepartments"
          } %>
  </div>

  <div class="form-group">
    <%= form.label :department, "Department" %>
    <%= form.select :department,
          options_for_select(@department_options, @prefill_data[:department]),
          {},
          class: "form-control",
          id: "department-select",
          data: {
            gsabss_selects_target: "department",
            action: "change->gsabss-selects#loadUnits"
          } %>
  </div>

  <div class="form-group">
    <%= form.label :unit, "Unit" %>
    <%= form.select :unit,
          options_for_select(@unit_options, @prefill_data[:unit]),
          {},
          class: "form-control",
          id: "unit-select",
          data: { gsabss_selects_target: "unit" } %>
  </div>
</div>
      </div>

<!-- Page 3: Incident Details -->
<div class="form-page" style="display:none;">
  <h2>Incident Details</h2>
        <div class="form-row d-flex flex-wrap">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :date_of_incident, "Date of Incident" %>
            <%= form.datetime_local_field :date_of_incident, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :location_where_event_occurred, "Location Where Event Occurred" %>
            <%= form.select :location_where_event_occurred,
                  options_for_select(['HOA', 'Service Building', 'JJC']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true } %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :witness_name, "Witness Name" %>
            <%= form.text_field :witness_name, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :witness_phone, "Witness Phone" %>
            <%= form.text_field :witness_phone, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :was_the_victim_injured, "Was the victim injured" %>
            <%= form.select :was_the_victim_injured,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true, data: { conditional_trigger: 'was_the_victim_injured' } } %>
          </div>
          <div class="conditional-field" data-depends-on="was_the_victim_injured" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :specify_the_injuries, "Specify the injuries" %>
            <%= form.text_field :specify_the_injuries, class: "form-control" %>
          </div>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :were_the_police_involved, "Were the Police Involved" %>
            <%= form.select :were_the_police_involved,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true, data: { conditional_trigger: 'were_the_police_involved' } } %>
          </div>
          <div class="conditional-field" data-depends-on="were_the_police_involved" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :which_police_department, "Which Police Department" %>
            <%= form.text_field :which_police_department, class: "form-control" %>
          </div>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :police_report_filed, "Police Report Filed" %>
            <%= form.select :police_report_filed,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true, data: { conditional_trigger: 'police_report_filed' } } %>
          </div>
          <div class="conditional-field" data-depends-on="police_report_filed" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :police_report_number, "Police Report Number" %>
            <%= form.text_field :police_report_number, class: "form-control" %>
          </div>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :was_the_victims_union_rep_notified, "Was the Victims Union Rep Notified" %>
            <%= form.select :was_the_victims_union_rep_notified,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true, data: { conditional_trigger: 'was_the_victims_union_rep_notified' } } %>
          </div>
          <div class="conditional-field" data-depends-on="was_the_victims_union_rep_notified" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :union_rep_name, "Union Rep Name" %>
            <%= form.text_field :union_rep_name, class: "form-control" %>
          </div>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :was_the_victims_supervisor_notified, "Was the Victims Supervisor Notified" %>
            <%= form.select :was_the_victims_supervisor_notified,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true } %>
          </div>
        </div>
      </div>

<!-- Page 4: Incident Details Cont'd -->
<div class="form-page" style="display:none;">
  <h2>Incident Details Cont'd</h2>
        <div class="form-row d-flex flex-wrap">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :any_action_taken_by_employer, "Any Action Taken by Employer" %>
            <%= form.select :any_action_taken_by_employer,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true, data: { conditional_trigger: 'any_action_taken_by_employer' } } %>
          </div>
          <div class="conditional-field" data-depends-on="any_action_taken_by_employer" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :describe_action_taken_, "Describe Action Taken " %>
            <%= form.text_area :describe_action_taken_, rows: 5, class: "form-control" %>
          </div>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :assailantperpetrator, "Assailant/Perpetrator" %>
            <%= form.select :assailantperpetrator,
                  options_for_select(['Intruder', 'Customer', 'Patient', 'Resident', 'Client', 'Visitor', 'Student', 'Co-Worker', 'Former Worker', 'Supervisor', 'Family', 'Friend', 'Other']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true, data: { conditional_trigger: 'assailantperpetrator' } } %>
          </div>
          <div class="conditional-field" data-depends-on="assailantperpetrator" data-show-values="[&quot;Other&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :other, "Other" %>
            <%= form.text_field :other, class: "form-control" %>
          </div>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :assailantperpetrator_name, "Assailant/Perpetrator Name" %>
            <%= form.text_field :assailantperpetrator_name, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :describe_the_incident, "Describe the Incident" %>
            <%= form.text_area :describe_the_incident, rows: 5, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :incident_disposition, "Incident Disposition" %>
            <%= form.select :incident_disposition,
                  options_for_select(['No Action Taken', 'Arrest', 'Warning', 'Suspension', 'Reprimand', 'Other']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true } %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :other_specify, "Other, Specify" %>
            <%= form.text_field :other_specify, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :did_the_incident_involve_a_weapon, "Did the Incident Involve a Weapon" %>
            <%= form.select :did_the_incident_involve_a_weapon,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true, data: { conditional_trigger: 'did_the_incident_involve_a_weapon' } } %>
          </div>
          <div class="conditional-field" data-depends-on="did_the_incident_involve_a_weapon" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :describe_the_weapon, "Describe the Weapon" %>
            <%= form.text_area :describe_the_weapon, rows: 5, class: "form-control" %>
          </div>
          </div>
        </div>
      </div>

<!-- Page 5: Corrective Action Safety Officer Only -->
<div class="form-page" style="display:none;">
  <h2>Corrective Action Safety Officer Only</h2>
        <div class="form-row d-flex flex-wrap">
        <% field_654_editable = (session.dig(:user, 'employee_id').to_s == '135272') %>
<div class="form-group flex-fill<%= ' field-restricted' unless field_654_editable %>">
  <%= form.label :was_the_problem_corrected_immediately, "Was the Problem Corrected Immediately" %>
            <small class="restriction-notice">To be filled by: Gary Howard</small>
            <%= form.select :was_the_problem_corrected_immediately,
                  options_for_select(['Yes', 'No', 'No corrective action required']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: field_654_editable && true, disabled: !field_654_editable } %>
          </div>
        <% field_655_editable = (session.dig(:user, 'employee_id').to_s == '135272') %>
<div class="form-group flex-fill<%= ' field-restricted' unless field_655_editable %>">
  <%= form.label :will_inspection_checklists_procedures_andor_training_have_to_be_modified_to_prevent_recurrence, "Will inspection checklists, procedures and/or training have to be modified to prevent recurrence" %>
            <small class="restriction-notice">To be filled by: Gary Howard</small>
            <%= form.select :will_inspection_checklists_procedures_andor_training_have_to_be_modified_to_prevent_recurrence,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: field_655_editable && true, disabled: !field_655_editable } %>
          </div>
        <% field_656_editable = (session.dig(:user, 'employee_id').to_s == '135272') %>
<div class="form-group flex-fill<%= ' field-restricted' unless field_656_editable %>">
  <%= form.label :additional_comments, "Additional Comments" %>
            <small class="restriction-notice">To be filled by: Gary Howard</small>
            <%= form.text_area :additional_comments, rows: 5, class: "form-control", disabled: !field_656_editable %>
          </div>
        <% field_657_editable = (session.dig(:user, 'employee_id').to_s == '135272') %>
<div class="form-group flex-fill<%= ' field-restricted' unless field_657_editable %>">
  <%= form.label :targeted_corrective_action_completion_date, "Targeted Corrective Action Completion Date" %>
            <small class="restriction-notice">To be filled by: Gary Howard</small>
            <%= form.datetime_local_field :targeted_corrective_action_completion_date, class: "form-control", required: field_657_editable && true, disabled: !field_657_editable %>
          </div>
        <% field_658_editable = (session.dig(:user, 'employee_id').to_s == '135272') %>
<div class="form-group flex-fill<%= ' field-restricted' unless field_658_editable %>">
  <%= form.label :actual_corrective_action_completion_date, "Actual Corrective Action Completion Date" %>
            <small class="restriction-notice">To be filled by: Gary Howard</small>
            <%= form.datetime_local_field :actual_corrective_action_completion_date, class: "form-control", disabled: !field_658_editable %>
          </div>
        </div>
      </div>

    <!-- Navigation Buttons -->
    <div class="navigation-buttons d-flex justify-content-between">
      <div>
        <button type="button" id="prevBtn" data-action="click->form-navigation#prevPage" style="display:none;">Previous</button>
      </div>
      <div>
        <button type="button" id="nextBtn" data-action="click->form-navigation#nextPage">Next</button>
        <%= form.submit "Submit", data: { form_navigation_target: "submitButton" }, style: "display:none;" %>
      </div>
    </div>

    <!-- Progress (5 steps) -->
    <div class="progress-wrapper">
      <div class="progress-bar-container">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div class="progress-dots">
        <% 5.times do |index| %>
          <div class="dot <%= 'active' if index == 0 %>"></div>
        <% end %>
      </div>
    </div>

  <% end %>
</div>
