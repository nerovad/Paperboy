<div class="form-header">
  <img src="<%= @form_logo %>" alt="Parking Lot Logo" />
</div>

<h1>Parking Lot Submission Form</h1>

<%= form_with model: @parking_lot_submission, local: true do |form| %>
  <% @form_pages.each_with_index do |page, page_index| %>
    <div class="form-page" style="<%= page_index == 0 ? '' : 'display:none;' %>">
      <h2><%= page[:title] %></h2>

      <div class="form-row">
        <% page[:fields].each do |field| %>
          <div class="form-group">
            <%= form.label field[:name], field[:label] %>

            <% if field[:type] == 'select' %>
              <%= form.select field[:name], options_for_select(field[:options]), {}, class: "form-control" %>
            <% else %>
              <%= form.text_field field[:name], required: field[:required], class: "form-control" %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>

  <div class="navigation-buttons">
    <button type="button" onclick="prevPage()">Previous</button>
    <button type="button" onclick="nextPage()">Next</button>
    <%= form.submit "Submit", id: "submitButton", style: "display: none;" %>
  </div>
<% end %>

<script>
  let currentPage = 0;
  const pages = document.querySelectorAll('.form-page');
  const submitButton = document.getElementById('submitButton');

  function showPage(index) {
    pages.forEach((page, i) => {
      page.style.display = i === index ? 'block' : 'none';
    });
    submitButton.style.display = index === pages.length - 1 ? 'inline-block' : 'none';
  }

  function nextPage() {
    if (currentPage < pages.length - 1) {
      currentPage++;
      showPage(currentPage);
    }
  }

  function prevPage() {
    if (currentPage > 0) {
      currentPage--;
      showPage(currentPage);
    }
  }

  document.addEventListener("DOMContentLoaded", () => {
    showPage(currentPage);
  });
</script>

