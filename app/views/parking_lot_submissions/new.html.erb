  <div class="form-header">
    <h1>Parking Lot Submission Form</h1>
  </div>

  <div class="form-wrapper">
    <%= form_with model: @parking_lot_submission, local: true do |form| %>

          <!-- Page 1: Employee Info -->
      <div class="form-page">
        <h2>Employee Info</h2>
        <div class="form-row d-flex flex-wrap">
          <div class="form-group flex-fill">
            <%= form.label :employee_id, "Employee ID" %>
            <%= form.text_field :employee_id, value: @prefill_data[:employee_id], class: "form-control", readonly: true %>
          </div>
          <div class="form-group flex-fill">
            <%= form.label :name, "Name" %>
            <%= form.text_field :name, value: @prefill_data[:name], class: "form-control", readonly: true %>
          </div>
          <div class="form-group flex-fill">
            <%= form.label :phone, "Phone" %>
            <%= form.text_field :phone, value: @prefill_data[:phone], class: "form-control", required: true %>
          </div>
          <div class="form-group flex-fill">
            <%= form.label :email, "Email" %>
            <%= form.text_field :email, value: @prefill_data[:email], class: "form-control", required: true %>
          </div>
        </div>
      </div>

     <!-- Page 2: Agency Info -->
<div class="form-page" style="display:none;">
  <h2>Agency Info</h2>
  <div data-controller="gsabss-selects" class="form-row d-flex flex-wrap">
    <div class="form-group">
      <%= form.label :agency, "Agency" %>
      <%= form.select :agency,
            options_for_select(@agency_options, @prefill_data[:agency]),
            {},
            class: "form-control",
            id: "agency-select",
            data: {
              gsabss_selects_target: "agency",
              action: "change->gsabss-selects#loadDivisions"
            } %>
    </div>

    <div class="form-group">
      <%= form.label :division, "Division" %>
      <%= form.select :division,
            options_for_select(@division_options, @prefill_data[:division]),
            {},
            class: "form-control",
            id: "division-select",
            data: {
              gsabss_selects_target: "division",
              action: "change->gsabss-selects#loadDepartments"
            } %>
    </div>

    <div class="form-group">
      <%= form.label :department, "Department" %>
      <%= form.select :department,
            options_for_select(@department_options, @prefill_data[:department]),
            {},
            class: "form-control",
            id: "department-select",
            data: {
              gsabss_selects_target: "department",
              action: "change->gsabss-selects#loadUnits"
            } %>
    </div>

    <div class="form-group">
      <%= form.label :unit, "Unit" %>
      <%= form.select :unit,
            options_for_select(@unit_options, @prefill_data[:unit]),
            {},
            class: "form-control",
            id: "unit-select",
            data: {
              gsabss_selects_target: "unit"
            } %>
    </div>
  </div>
</div>

      <!-- Page 3: Vehicle and Parking Info -->
      <div class="form-page" style="display:none;">
        <h2>Vehicle and Parking Info</h2>
        <div id="vehicle-wrapper">
          <%= form.fields_for :parking_lot_vehicles do |vf| %>
            <div class="vehicle-fields form-row border p-3 rounded mb-4">
              <%= render partial: "vehicle_fields", locals: { vf: vf } %>
            </div>
          <% end %>
        </div>
        <button type="button" id="add-vehicle" class="btn btn-secondary mt-2">+ Add Vehicle</button>
      </div>
      <!-- Navigation Buttons -->
      <div class="navigation-buttons d-flex justify-content-between">
        <div>
          <button type="button" id="prevBtn" style="display: none;">Previous</button>
        </div>
        <div>
          <button type="button" id="nextBtn">Next</button>
          <%= form.submit "Submit", style: "display: none;" %>
        </div>
      </div>
     <!-- Progress Bar -->
      <div class="progress-wrapper">
        <div class="progress-bar-container">
          <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-dots">
          <% 3.times do |index| %>
            <div class="dot <%= 'active' if index == 0 %>"></div>
          <% end %>
        </div>
      </div>
      <!-- Vehicle Template -->
      <div id="vehicle-template" style="display: none;">
        <%= form.fields_for :parking_lot_vehicles, ParkingLotVehicle.new, child_index: "NEW_RECORD" do |vf| %>
          <div class="vehicle-fields form-row border p-3 rounded mb-4">
            <%= render partial: "vehicle_fields", locals: { vf: vf } %>
            <button type="button" class="btn btn-danger remove-vehicle">âˆ’ Remove</button>
          </div>
        <% end %>
      </div>

    <% end %> <!-- form_with -->
  </div>
  </div>
