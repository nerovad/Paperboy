<div class="container">
  <div class="header-row">
    <h1>Form Templates</h1>
    <button type="button" 
            class="btn btn-primary"
            data-controller="form-builder"
            data-action="click->form-builder#openModal">
      âž• Create Form
    </button>
  </div>
  
  <% if @form_templates.any? %>
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Class Name</th>
          <th>Access</th>
          <th>Pages</th>
          <th>Fields</th>
          <th>Created</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @form_templates.each do |template| %>
          <tr>
            <td><%= template.name %></td>
            <td><code><%= template.class_name %></code></td>
            <td>
              <span class="badge <%= template.restricted? ? 'badge-warning' : 'badge-success' %>">
                <%= template.access_level.titleize %>
              </span>
              <% if template.restricted? %>
                <br><small><%= template.acl_group_name %></small>
              <% end %>
            </td>
            <td><%= template.page_count %></td>
            <td><%= template.form_fields.count %></td>
            <td><%= template.created_at.strftime("%m/%d/%Y") %></td>
            <td>
              <%= link_to "View", form_template_path(template), class: "btn btn-sm btn-info" %>
              
              <%= button_to "Delete", 
                            form_template_path(template), 
                            method: :delete,
                            class: "btn btn-sm btn-danger",
                            data: { confirm: "Are you sure? This will also delete the generated form files." } %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="empty-state">
      <p>No form templates yet.</p>
      <button type="button" 
              class="btn btn-primary"
              data-controller="form-builder"
              data-action="click->form-builder#openModal">
        Create Your First Form
      </button>
    </div>
  <% end %>
</div>

<!-- Render the modal on this page -->
<%= render "form_templates/create_modal", acl_groups: fetch_acl_groups %>
