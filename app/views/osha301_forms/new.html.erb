<!-- Generated by Paperboy Form Builder -->
<div class="form-header">
  <h1>OSHA 301</h1>
</div>

<div class="form-wrapper" data-controller="form-navigation conditional-fields">
  <%= form_with model: @osha301_form, local: true do |form| %>

<!-- Page 1: Employee Info -->
<div class="form-page">
  <h2>Employee Info</h2>
<div class="form-row d-flex flex-wrap">
  <div class="form-group flex-fill">
    <%= form.label :employee_id, "Employee ID" %>
    <%= form.text_field :employee_id,
          value: @prefill_data[:employee_id],
          class: "form-control",
          readonly: true %>
  </div>

  <div class="form-group flex-fill">
    <%= form.label :name, "Name" %>
    <%= form.text_field :name,
          value: @prefill_data[:name],
          class: "form-control",
          readonly: true %>
  </div>

  <div class="form-group flex-fill">
    <%= form.label :phone, "Phone" %>
    <%= form.text_field :phone,
          value: @prefill_data[:phone],
          class: "form-control",
          required: true,
          placeholder: "e.g. 555-555-5555",
          title: "Enter a 10-digit phone number like 555-555-5555",
          data: {
            controller: "phone",
            phone_target: "input",
            action: "input->phone#format paste->phone#format blur->phone#validate"
          },
          "aria-describedby": "phoneHelp phoneError",
          pattern: "\\d{3}-\\d{3}-\\d{4}",
          inputmode: "numeric",
          autocomplete: "tel" %>
    <small id="phoneHelp" class="help-text text-muted"></small>
    <div id="phoneError" data-phone-target="error" class="field-error" aria-live="polite"></div>
  </div>

  <div class="form-group flex-fill">
    <%= form.label :email, "Email" %>
    <%= form.text_field :email,
          value: @prefill_data[:email],
          class: "form-control",
          required: true %>
  </div>
</div>
      </div>

<!-- Page 2: Agency Info -->
<div class="form-page" style="display:none;">
  <h2>Agency Info</h2>
<div data-controller="gsabss-selects" class="form-row d-flex flex-wrap">
  <div class="form-group">
    <%= form.label :agency, "Agency" %>
    <%= form.select :agency,
          options_for_select(@agency_options, @prefill_data[:agency]),
          {},
          class: "form-control",
          id: "agency-select",
          data: {
            gsabss_selects_target: "agency",
            action: "change->gsabss-selects#loadDivisions"
          } %>
  </div>

  <div class="form-group">
    <%= form.label :division, "Division" %>
    <%= form.select :division,
          options_for_select(@division_options, @prefill_data[:division]),
          {},
          class: "form-control",
          id: "division-select",
          data: {
            gsabss_selects_target: "division",
            action: "change->gsabss-selects#loadDepartments"
          } %>
  </div>

  <div class="form-group">
    <%= form.label :department, "Department" %>
    <%= form.select :department,
          options_for_select(@department_options, @prefill_data[:department]),
          {},
          class: "form-control",
          id: "department-select",
          data: {
            gsabss_selects_target: "department",
            action: "change->gsabss-selects#loadUnits"
          } %>
  </div>

  <div class="form-group">
    <%= form.label :unit, "Unit" %>
    <%= form.select :unit,
          options_for_select(@unit_options, @prefill_data[:unit]),
          {},
          class: "form-control",
          id: "unit-select",
          data: { gsabss_selects_target: "unit" } %>
  </div>
</div>
      </div>

<!-- Page 3: Additonal Employee Info -->
<div class="form-page" style="display:none;">
  <h2>Additonal Employee Info</h2>
        <div class="form-row d-flex flex-wrap">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :street, "Street" %>
            <%= form.text_field :street, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :city, "City" %>
            <%= form.select :city,
                  options_for_select(['Ventura', 'Ojai', 'Santa Barbara', 'Camarillo', 'Los Angeles', 'Thousand Oaks', 'Somis', 'Oxnard']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true } %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :state, "State" %>
            <%= form.select :state,
                  options_for_select(['California']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true } %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :zip, "ZIP" %>
            <%= form.text_field :zip, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :date_of_birth, "Date of Birth" %>
            <%= form.datetime_local_field :date_of_birth, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :date_hired, "Date Hired" %>
            <%= form.datetime_local_field :date_hired, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :sex, "Sex" %>
            <%= form.select :sex,
                  options_for_select(['Male', 'Female']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true } %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :name_of_physician_or_other_health_care_professional, "Name of physician or other health care professional" %>
            <%= form.text_field :name_of_physician_or_other_health_care_professional, class: "form-control", required: true %>
          </div>
        </div>
      </div>

<!-- Page 4: Physician Information -->
<div class="form-page" style="display:none;">
  <h2>Physician Information</h2>
        <div class="form-row d-flex flex-wrap">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :was_treatment_given_away_from_the_worksite, "Was treatment given away from the worksite?" %>
            <%= form.select :was_treatment_given_away_from_the_worksite,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true, data: { conditional_trigger: 'was_treatment_given_away_from_the_worksite' } } %>
          </div>
          <div class="conditional-field" data-depends-on="was_treatment_given_away_from_the_worksite" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :facility_name, "Facility Name" %>
            <%= form.text_field :facility_name, class: "form-control" %>
          </div>
          </div>
          <div class="conditional-field" data-depends-on="was_treatment_given_away_from_the_worksite" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :facility_street_address, "Facility Street Address" %>
            <%= form.text_field :facility_street_address, class: "form-control" %>
          </div>
          </div>
          <div class="conditional-field" data-depends-on="was_treatment_given_away_from_the_worksite" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :facility_city, "Facility City" %>
            <%= form.text_field :facility_city, class: "form-control" %>
          </div>
          </div>
          <div class="conditional-field" data-depends-on="was_treatment_given_away_from_the_worksite" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :facility_state, "Facility State" %>
            <%= form.text_field :facility_state, class: "form-control" %>
          </div>
          </div>
          <div class="conditional-field" data-depends-on="was_treatment_given_away_from_the_worksite" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :facility_zip, "Facility ZIP" %>
            <%= form.text_field :facility_zip, class: "form-control" %>
          </div>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :was_the_employee_treated_in_an_emergency_room, "Was the employee treated in an emergency room?" %>
            <%= form.select :was_the_employee_treated_in_an_emergency_room,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true } %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :was_the_employee_hospitalized_overnight_as_an_inpatient, "Was the employee hospitalized overnight as an in-patient?" %>
            <%= form.select :was_the_employee_hospitalized_overnight_as_an_inpatient,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true } %>
          </div>
        </div>
      </div>

<!-- Page 5: Case Information -->
<div class="form-page" style="display:none;">
  <h2>Case Information</h2>
        <div class="form-row d-flex flex-wrap">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :case_number_from_the_log, "Case Number from the Log" %>
            <%= form.text_field :case_number_from_the_log, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :date_of_injury_or_illness, "Date of Injury or Illness" %>
            <%= form.datetime_local_field :date_of_injury_or_illness, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :time_employee_began_work, "Time employee began work" %>
            <%= form.datetime_local_field :time_employee_began_work, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :time_of_event, "Time of Event" %>
            <%= form.datetime_local_field :time_of_event, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :what_happened_tell_us_how_the_injury_occurred, "What happened? Tell us how the injury occurred." %>
            <%= form.text_area :what_happened_tell_us_how_the_injury_occurred, rows: 5, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :what_was_the_injury_or_illness, "What was the injury or illness?" %>
            <%= form.text_area :what_was_the_injury_or_illness, rows: 5, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :what_was_the_employee_doing_just_before_the_incident_occurred, "What was the employee doing just before the incident occurred?" %>
            <%= form.text_area :what_was_the_employee_doing_just_before_the_incident_occurred, rows: 5, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :what_object_or_substance_directly_harmed_the_employee, "What object or substance directly harmed the employee?" %>
            <%= form.text_area :what_object_or_substance_directly_harmed_the_employee, rows: 5, class: "form-control", required: true %>
          </div>
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :did_employee_die, "Did employee die?" %>
            <%= form.select :did_employee_die,
                  options_for_select(['Yes', 'No']),
                  { include_blank: "Select..." },
                  { class: "form-control", required: true, data: { conditional_trigger: 'did_employee_die' } } %>
          </div>
          <div class="conditional-field" data-depends-on="did_employee_die" data-show-values="[&quot;Yes&quot;]" style="display: none;">
<div class="form-group flex-fill<%= '' %>">
  <%= form.label :date_of_death, "Date of Death" %>
            <%= form.datetime_local_field :date_of_death, class: "form-control" %>
          </div>
          </div>
        </div>
      </div>

    <!-- Navigation Buttons -->
    <div class="navigation-buttons d-flex justify-content-between">
      <div>
        <button type="button" id="prevBtn" data-action="click->form-navigation#prevPage" style="display:none;">Previous</button>
      </div>
      <div>
        <button type="button" id="nextBtn" data-action="click->form-navigation#nextPage">Next</button>
        <%= form.submit "Submit", data: { form_navigation_target: "submitButton" }, style: "display:none;" %>
      </div>
    </div>

    <!-- Progress (5 steps) -->
    <div class="progress-wrapper">
      <div class="progress-bar-container">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div class="progress-dots">
        <% 5.times do |index| %>
          <div class="dot <%= 'active' if index == 0 %>"></div>
        <% end %>
      </div>
    </div>

  <% end %>
</div>
